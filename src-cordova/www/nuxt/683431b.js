(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{638:function(t,e,n){"use strict";(function(t){n(67),n(31),n(27),n(12),n(17),n(45);var r=n(5),o=n(13),c=n(108),d=n(131),l=n(171),f=n(631),h=n(107),m=n(203),v=n(205),k=n(96),x=n(56),w=n(204),_=n(584),y=n(597),V=n(781),R=n(782),T=n(599),P=n(167),S=n(80),j=n(50),z=n(88),I=n(580),L=n(36),D=n(601),O=n(602),E=n(802),C=n(795),K=n(605),F=n(579),A=n(92),B=Object.assign(o.MODES,{abc:99,cat:999,q:9999});e.a={components:{VBtn:c.a,VImg:d.a,VList:l.a,VSubheader:f.a,VListItem:h.a,VListGroup:m.a,VListItemGroup:v.a,VListItemIcon:k.a,VListItemContent:x.a,VListItemTitle:x.c,VListItemSubtitle:x.b,VListItemAction:w.a,VTextField:_.a,VBadge:y.a,VChip:V.a,VChipGroup:R.a,VBottomSheet:T.a,VCard:P.a,VCardTitle:S.c,VCardText:S.b,VToolbar:j.a,VToolbarTitle:z.a,VSpacer:I.a,VSheet:L.a,VForm:D.a,VSkeletonLoader:O.a,VTooltip:E.a,VTreeview:C.a,VDivider:K.a,VAlert:F.a,SkSvg:A.default},asyncData:function(t){return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.store,r=n.state.active.store){e.next=8;break}return o=t.params.id,e.next=6,n.dispatch("loadStore",{id:o});case 6:r=e.sent,n.commit("active/setStore",r);case 8:return e.abrupt("return",{parent:r,has:{store:!!r}});case 9:case"end":return e.stop()}}),e)})))()},data:function(){return{mode:B.none,showParams:!1,totals:null,abc:null,kinds:null,activeKind:null,data:null,q:null}},computed:{tenant:function(){return this.parent?this.parent.id:"00000000-0000-0000-0000-000000000666"},hasKinds:function(){return!!this.kinds&&this.kinds.length>0},canFind:function(){return!!this.totals&&this.totals.n>0}},created:function(){this.refresh()},activated:function(){var t=this;this.data||this.refresh().then((function(){t.show_find_params()}))},deactivated:function(){this.showParams=!1,$(".sk-find-params").css({display:"none"})},methods:{refresh:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,o,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.mode=B.loading,n.prev=1,e.getcats(null),r={type:"query",query:"37afe6aa-4d4b-4f27-a34c-173e746cd7d7.searchData",params:{that:1,tenantid:e.tenant,prms:""}},n.next=6,e.$http.post(r);case 6:if(o=n.sent,console.log(o),!o.error){n.next=10;break}throw o.error;case 10:c=[],o.result.data.map((function(a){e.totals||(e.totals={n:a[0]},e.totals.dt=t.formatDate(new Date(a[1]))),c.push({a:a[2],n:a[3],active:!1})})),e.abc=c,e.mode=B.default,n.next=20;break;case 16:n.prev=16,n.t0=n.catch(1),e.mode=B.error,console.log("ERR: load abc:",n.t0);case 20:case"end":return n.stop()}}),n,null,[[1,16]])})))()},find:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,o,data;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.mode=B.loading,e.data=null,r={type:"query",query:"37afe6aa-4d4b-4f27-a34c-173e746cd7d7.searchData",params:{that:2,tenantid:e.tenant,prms:t}},n.prev=3,n.next=6,e.$http.post(r);case 6:if(!(o=n.sent).error){n.next=9;break}throw o.error;case 9:data=[],o.result.data.map((function(a){data.push({id:a[4],name:a[6],price:a[11],img:a[5],unit:a[13]})})),e.totals||(e.totals={n:0}),e.totals.n=data.length,e.data=data,e.$nextTick((function(){e.$forceUpdate()})),n.next=20;break;case 17:n.prev=17,n.t0=n.catch(3),console.log("ERR: load data",n.t0);case 20:e.$nextTick((function(){e.mode=B.default}));case 21:case"end":return n.stop()}}),n,null,[[3,17]])})))()},getcats:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e,n.abrupt("return",new Promise((function(n,o){e.$store.dispatch("active/getCats",t).then((function(e){t||(r.kinds=e),n(e.length)})).catch((function(t){console.log("ERR on cats:",t),o(t)}))})));case 2:case"end":return n.stop()}}),n)})))()},oncat:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.activeKind=t,e.find("#"+t.id),e.showParams=!1;case 3:case"end":return n.stop()}}),n)})))()},onabc:function(a){this.abc.map((function(t){t.active=t.a===a.a})),this.find(a.a),this.showParams=!1},_text_find:function(e){e&&(e.stopPropagation(),e.preventDefault());var n=this.$refs["sk-find-inp"];return t.isEmpty(this.q)||this.q.length<3?(n.valid=!1,n.error=!0,$(n.$el).find("input").trigger("focus"),app.msg({text:"Для поиска введите не менее 3-х символов",color:"warning"}),!1):(this.showParams=!1,this.find(this.q),!1)},show_find_params:function(){this.showParams=(new Date).getTime(),this.$nextTick((function(){$(".sk-find-text input").trigger("focus")}))},open:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.showParams=!1,e.$store.commit("active/setAction",t),e.$router.push({path:"/stores/"+e.tenant+"/catalog/"+t.id});case 3:case"end":return n.stop()}}),n)})))()},back:function(){this.data?(this.data=null,this.show_find_params()):this.$router.go(-1)}},watch:{tenant:function(){this.mode=B.none,this.showParams=!1,this.totals=null,this.abc=null,this.kinds=null,this.activeKind=null,this.data=null,this.q=null},showParams:function(t){if(t){var e=$(".sk-find-params");e.css({display:""}),e.find("input").trigger("focus")}}},render:function(e){var n=this,r=this.$http.env.rpcUrl,o=this.parent.brandcolor||"orange",c=[],b=e("sk-svg",{props:{xref:"#ico-search"}});return this.totals&&this.totals.n&&this.totals.n>0&&(b=e("v-badge",{props:{content:this.totals.n,color:o},class:{"sk-totals":!0},attrs:{id:"sk-find-totals"}},[b]),c.push(e("v-btn",{props:{icon:!0,fab:!0,fixed:!0,dark:!0,small:!0},style:{top:"8px",right:"1rem",zIndex:9,"background-color":o},on:{click:this.show_find_params}},[b]))),this.mode===B.loading?c.push(e("div",{style:{"margin-top":"64px"}},[[1,2,3,4,5].map((function(){return e("v-skeleton-loader",{props:{type:"list-item-avatar-three-line"}})}))])):this.data&&c.push(e("v-list",{props:{dense:!0},class:{"sk-find-prods":!0}},[this.data.length>0?this.data.map((function(c){return e("v-list-item",{key:"prod-"+c.id,on:{click:function(){n.open(c)}}},[e("v-list-item-icon",{class:{"sk-prod-image":!0}},[t.isEmpty(c.img)?e("sk-svg",{props:{xref:"#ico-box-full"},style:{color:o}}):e("v-img",{props:{contain:!0,"max-height":86,src:r+"/static/model/view/"+c.img}})]),e("v-list-item-content",[c.name,e("div",{class:{"sk-price":!0}},[Number(c.price)>0?c.price+"р.":"",t.isEmpty(c.unit)?null:e("span",{class:{"sk-unit":!0}}," ("+c.unit+")")])]),e("v-list-item-icon",[e("sk-svg",{props:{xref:"#ico-right"},style:{color:"#ccc"}})])])})):e("v-list-item",{key:"prod-not-found",props:{"three-line":!0}},[e("v-list-item-content",[e("v-list-item-subtitle","По Вашему запросу ничего не найдено - попробуйте изменить условия поиска.")])])])),this.canFind?c.push(e("v-bottom-sheet",{props:{value:this.showParams,width:"100%",scrollable:!0},class:{"sk-find-bottom":!0}},[e("v-card",{props:{width:"100%","min-height":420},class:{"sk-find-params":!0}},[e("v-card-title",{style:{"background-color":o,color:"#fff"}},["поиск",e("v-spacer"),this.totals?this.totals.dt:null]),e("v-card-text",[e("v-form",{on:{submit:this._text_find}},[e("div",{class:{"sk-find-text":!0}},[e("v-text-field",{props:{label:"наименование",rules:[function(e){return t.isEmpty(e)||!!e&&e.length>2||"не менее 3-х символов"}]},ref:"sk-find-inp",on:{input:function(t){n.q=t}}}),e("v-btn",{props:{tile:!0,type:"submit",color:"grey lighten-3",elevation:0}},[e("sk-svg",{props:{xref:"#ico-search",width:16,height:16}})])])]),this.abc?[e("v-subheader","по алфавиту"),e("v-chip-group",{class:{"sk-abc":!0}},[this.abc.map((function(a){return e("v-chip",{key:"search-a-"+a.a,props:{small:!0,value:a.n,color:a.active?o:"default"},on:{click:function(){n.onabc(a)}}},a.a)}))]),e("v-divider")]:null,this.hasKinds?[e("v-subheader","по категории"),e("v-treeview",{props:{activatable:!0,transition:!0,"open-on-click":!0,items:this.kinds,"item-children":"childs","item-key":"id","return-object":!0,"load-children":this.getcats,"expand-icon":"fas fa-chevron-down","item-text":"kindname","selection-type":"independent",value:[this.activeKind]},on:{"update:active":function(t){t.length>0&&n.oncat(t[0])}},scopedSlots:{prepend:function(t){if(t.item.kindimage)return e("v-img",{props:{height:"32px",width:"32px",src:r+"/static/model/view/"+t.item.kindimage}})}}})]:null])])])):this.mode!==B.loading&&c.push(e("v-alert",{props:{border:"top",type:"warning","colored-border":!0,elevation:2},style:{margin:"96px auto 0 auto",width:"95%"}},["Магазин пока не предоставил номенклатуру своих товаров, попробуйте зайти позже."])),e("v-sheet",{key:"search-"+this.tenant},c)}}}).call(this,n(13))},663:function(t,e,n){var content=n(739);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(9).default)("623c837a",content,!0,{sourceMap:!1})},664:function(t,e,n){var content=n(741);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(9).default)("18becad4",content,!0,{sourceMap:!1})},738:function(t,e,n){"use strict";n(663)},739:function(t,e,n){(e=n(8)(!1)).push([t.i,".v-icon.v-icon.v-treeview-node__toggle{font-size:12px!important;width:24px;height:24px;text-align:center}.v-icon.v-icon.v-treeview-node__toggle:before{margin-top:4px}.v-treeview-node__label{font-size:1.125rem}.v-toolbar #sk-find-totals{margin-right:1rem}.v-toolbar #sk-find-totals .v-badge__wrapper{top:4px!important}.v-toolbar #sk-find-totals .v-badge__badge{border:1px solid #fff;border-color:#fff!important;box-shadow:0 2px 4px rgba(0,0,0,.22)}",""]),t.exports=e},740:function(t,e,n){"use strict";n(664)},741:function(t,e,n){(e=n(8)(!1)).push([t.i,".text-muted[data-v-5991d092]{color:#6c757d;font-size:.75rem;line-height:1.115}.sk-whited[data-v-5991d092]{background:#fff}.v-toolbar[data-v-5991d092]{width:100%}.sk-find-bottom[data-v-5991d092]{background:#fff}.sk-find-params .v-card__title[data-v-5991d092]{font-weight:400;font-size:1rem;color:#fff}.sk-find-params .sk-find-text[data-v-5991d092]{display:flex;align-items:center;justify-content:space-between}.sk-find-params .sk-find-text button[type=submit][data-v-5991d092]{margin-top:-8px}.sk-find-params .v-subheader[data-v-5991d092]{padding:16px 0 4px;font-style:italic}.sk-find-params .v-chip-group .v-chip--active[data-v-5991d092]{color:#fff}.sk-find-params .v-treeview-node__toggle.fas[data-v-5991d092]{font-size:.8rem!important}.sk-find-params .v-treeview[data-v-5991d092]{margin:0 -24px}.sk-find-params .v-treeview .v-treeview-node__prepend .v-image.v-responsive[data-v-5991d092]{box-shadow:0 2px 4px rgba(0,0,0,.28);border-radius:500px}.sk-find-info[data-v-5991d092]{padding-top:96px}.sk-find-info h2[data-v-5991d092]{font-weight:300;margin:2rem 0 0}.sk-find-info .v-card__title[data-v-5991d092]{flex-direction:column;align-content:flex-start;text-align:left;align-items:flex-start;font-weight:400;font-size:.9rem}.sk-find-info .v-card__text[data-v-5991d092]{display:flex;flex-direction:column}.sk-find-info .v-card__text .v-btn[data-v-5991d092]{margin-top:1rem;width:14rem;align-self:center}.sk-find-info .v-card__text .v-btn svg[data-v-5991d092]{margin-right:1rem}.sk-find-prods[data-v-5991d092]{padding-bottom:2rem;height:100vh;overflow:auto;padding-top:64px}.sk-find-prods .v-list-item[data-v-5991d092]{border-bottom:1px solid #ccc;line-height:1.115;font-size:1rem}.sk-find-prods .v-list-item .v-list-item__icon[data-v-5991d092]{align-self:center!important}.sk-find-prods .v-list-item .v-list-item__icon.sk-prod-image[data-v-5991d092]{width:64px;height:auto;max-height:64px;margin:.5rem 1rem .5rem 0!important}.sk-find-prods .v-list-item .sk-price[data-v-5991d092]{font-size:1.25rem;color:#ad0900}.sk-find-prods .v-list-item .sk-price .sk-unit[data-v-5991d092]{color:#757575;font-size:.85rem}",""]),t.exports=e},801:function(t,e,n){"use strict";n.r(e);var r=n(638).a,o=(n(738),n(740),n(29)),component=Object(o.a)(r,void 0,void 0,!1,null,"5991d092",null);e.default=component.exports}}]);