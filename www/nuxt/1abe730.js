(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{644:function(t,e,r){"use strict";(function(t){r(181),r(67),r(70),r(12),r(17),r(21),r(47),r(76),r(44),r(98),r(24),r(227),r(45);var o=r(5),n=r(13),d=r(92),c=r(751),l=r(610),h=r(625),m=r(624),f=r(108),v=r(131),k=r(171),x=r(631),_=r(107),y=r(203),w=r(205),V=r(96),j=r(56),O=r(167),R=r(80),T=r(580),S=r(36),z=r(602),I=r(605),L=r(599),D=r(783),C=r(597),E=r(746),H=r(584),B=r(214),P=Object.assign(n.MODES,{ready:16,order:32,added:64,success:128});e.a={head:function(){return{title:this.prod?this.prod.promogoods:"loading...",meta:[{hid:"description",name:"description",content:this._getdescr()}]}},asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var r,o,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.params.id,o=t.store,e.prev=1,e.next=4,o.dispatch("active/getProd",{id:r});case 4:return p=e.sent,e.abrupt("return",{prod:p,error:null,mode:P.default});case 8:return e.prev=8,e.t0=e.catch(1),console.log("PROD ERROR:",e.t0),e.abrupt("return",{prod:null,error:e.t0,mode:P.error});case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))()},data:function(){return{sheet:!1,n:1,note:null,today:!0,adding:!1,self:!1,image:{src:void 0,height:180,fab:!1,h:!1}}},directives:{Scroll:B.a},computed:{store:function(){return this.$store.state.active.store},total:function(){var p=parseFloat(this.prod.newprice);return this.n*p}},fetch:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){var t=this;if(console.log("PROD (fetch): ",this.prod),this.prod){this.$route.params.id;try{if(this.prod.promoimage){var e=this.$http.env.rpcUrl;fetch(e+"/static/model/view/"+this.prod.promoimage.id).then((function(t){return t.blob()})).then((function(data){var e=new Blob([data]);t.image.src=URL.createObjectURL(e)})).catch((function(t){console.log("Image fail:",t)}))}this.image.height=180,this.image.fab=!1,this._set_fab(!1),setTimeout((function(){t.activate(),t.see()}),100),this.mode=P.default}catch(t){console.log("On prod err:",t),this.mode=P.error,t.data&&/^(access)+/i.test(t.data)&&this.$router.replace({name:"index"})}}})),components:{VContainer:l.a,VRow:h.a,VCol:m.a,VBtn:f.a,VImg:v.a,VList:k.a,VSubheader:x.a,VListItem:_.a,VListGroup:y.a,VListItemGroup:w.a,VListItemIcon:V.a,VListItemContent:j.a,VListItemTitle:j.c,VListItemSubtitle:j.b,VCard:O.a,VCardText:R.b,VCardTitle:R.c,VSpacer:T.a,VSheet:S.a,VSkeletonLoader:z.a,VDivider:I.a,VBottomSheet:L.a,VRating:D.a,VBadge:C.a,VTextarea:E.a,VTextField:H.a,SkSvg:d.default},methods:{_getdescr:function(){var a=["on-line price"];return this.store&&(a.push(this.store.title),this.store.location&&a.push(t.formatAddress(this.store.location,!0)),this.prod&&a.push(this.prod.promogoods)),a.join(",")},activate:function(){var t=this;this.$nextTick((function(){$(t.$el).find(".sk-choice input").css({"text-align":"center","max-height":"3rem"});var e=$(t.$el).find(".sk-descr");e.click((function(){"ellipsis"===e.attr("data-trunc")?(e.attr("data-trunc","none"),e.html(t.prod.promodesc)):(Object(c.ellipsis)(".sk-descr",3),e.attr("data-trunc","ellipsis"))})),e.trigger("click"),$([document.documentElement,document.body]).animate({scrollTop:0},100)}))},see:function(){var t={type:"core-create",query:"sin2:/v:1cb7dc21-2866-4e29-905c-e183236ffa7a",params:[{id:"tenantid",type:"id",value:this.prod.tenantid},{id:"userid",type:"id",value:this.prod.userid},{id:"deviceip",type:"string",value:""},{id:"devicemodel",type:"string",value:""},{id:"deviceplatform",type:"string",value:""},{id:"deviceuuid",type:"string",value:""},{id:"deviceversion",type:"string",value:""},{id:"productid",type:"id",value:this.prod.id},{id:"regdt",type:"datetime",value:new Date}]};this.$http.post(t)},doRait:function(t){var e=this,r={type:"core-create",query:"sin2:/v:e4737054-e251-44ff-8fc7-9eba56dd1faf",params:[{id:"tenantid",type:"id",value:this.prod.tenantid},{id:"userid",type:"id",value:this.prod.userid},{id:"productid",type:"id",value:this.prod.id},{id:"rating",type:"integer",value:t},{id:"regdt",type:"datetime",value:new Date}]};this.$http.post(r).always((function(){e.prod.rating=t,e.sheet=!1}))},pm:function(t){var e=this.n+(t?1:-1);e<1&&(e=1),this.n=e,this.$store.getters["basket/has"](this.prod.id)&&this._to_basket()},in_cart:function(){return!!this.prod&&this.$store.getters["basket/has"](this.prod.id)},_to_basket:function(){var e=this.fill?this.fill.id:t.isEmpty(this.prod.orgid)?this.prod.tenantid:this.prod.orgid,p=Object.assign({},this.prod);p.store={id:e},p.num=this.n,p.total=this.total,p.at=this.at,p.note=this.note,this.$store.dispatch("basket/add",p)},to_basket:function(){var t=this;if(this.in_cart())return this.$router.replace({path:"/stores/"+this.store.id+"/basket"}),!1;this._to_basket(),this.mode=P.added,this.adding=!0,setTimeout((function(){t.adding=!1}),600)},from_basket:function(){this.$store.dispatch("basket/rm",{id:this.prod.id}),this.n=1,this.mode=P.order,this.$forceUpdate()},_adjustH:function(){var t=160,h2=this.image.domHeight?this.image.domHeight-160:0;h2>0&&(t+=h2),$(this.$el).find(".container").css({"padding-bottom":t+"px"})},_set_fab:function(t){var e=this;t?($(this.$el).find(".v-image .v-image__image").fadeOut(),$(this.$el).find(".sk-btn-thumb").fadeIn({always:function(){e.image.fab=!0}})):($(this.$el).find(".v-image .v-image__image").fadeIn(),$(this.$el).find(".sk-btn-thumb").fadeOut({always:function(){e.image.fab=!1}}))},_scrolling:function(t){var e=this;this.image.h&&(clearTimeout(this.image.h),this.image.h=!1),this.image.h=setTimeout((function(){e.image.h=!1;var t=window.scrollY;void 0!==t&&(t>64?e.image.fab||e._set_fab(!0):e.image.fab&&e._set_fab(!1))}),50)}},render:function(e){var r=this,o=this.prod,n=this.store;if(!o||!n)return e("v-skeleton-loader",{props:{type:"card"}});var d=!o.isproduct,c=this.in_cart(),l=(this.store.hasdelivery,this.store.brandcolor||"red darken-4"),meta=[];return o.timecook&&meta.push(e("div",{class:"sk-time"},[e("sk-svg",{props:{xref:"#ico-clock"}}),o.timecook])),(o.calories||o.pfc)&&meta.push(e("div",{class:"sk-calls"},[e("sk-svg",{props:{xref:"#ico-drumstick"}}),(o.calories?o.calories:"")+(o.pfc?" ("+o.pfc+")":"")])),o.amount&&meta.push(e("div",{class:"sk-ammount"},[e("sk-svg",{props:{xref:"#ico-balance-scale"}}),o.amount])),o.promodesc&&meta.push(e("div",{class:"sk-desc"},o.promodesc)),e("v-container",{props:{fluid:!0},class:{"sk-prod-conte":!0},directives:[{name:"scroll",rawName:"v-scroll",value:function(t){r._scrolling(t)}}]},[e("v-row",[e("v-col",{props:{cols:12}},[e("v-card",{key:"prod-"+o.id,attrs:{id:"sk-prod"},class:{"sk-prod":!0,"sk-in-cart":c},props:{flat:!0,shaped:!0}},[e("v-img",{props:{src:this.image.src,eager:!0,contain:!0,"max-height":280,"min-height":72},ref:"prod-image",on:{load:function(){var img=$(r.$refs["prod-image"].$el);img.animate({opacity:1}),r.image.domHeight=img.height(),r._adjustH()}}}),e("v-card-text",[e("v-btn",{props:{fab:!0,"x-large":!0,right:!0,top:!0},class:{"sk-btn-thumb":!0},style:{background:'transparent url("'+this.image.src+'") center center scroll no-repeat',display:this.image.fab?"":"none"},on:{click:function(){r._set_fab(!1),window.scrollTo(0,0)}}}),e("h3",{class:"sk-name"},o.promogoods),e("div",{class:"sk-prod-meta"},meta),e("div",{class:"sk-price"},[e("div",[o.newprice+" руб.",t.isEmpty(o.unitname)?null:" / "+o.unitname]),e("div",{style:{color:l}},this.total+" руб.")]),e("div",{class:"sk-raiting"},[e("v-btn",{props:{text:!0},on:{click:function(){r.sheet=(new Date).getTime()}}},[e("sk-svg",{props:{xref:"#ico-star"}}),o.rating?o.rating:"оценить"])]),d?null:e("div",{class:"sk-quantity"},["количество",e("div",[e("v-btn",{props:{text:!0},on:{click:function(){r.pm(!1)}}},"-"),e("v-text-field",{props:{value:this.n,color:l,"hide-details":!0,"single-line":!0},on:{input:function(t){var e=Number(t);r.n=e||1}}}),e("v-btn",{props:{text:!0},on:{click:function(){r.pm(!0)}}},"+")])]),e("v-textarea",{props:{value:this.note,"full-width":!0,rows:1,"auto-grow":!0,dense:!0,messages:"комментарий к заказу",color:l},class:{"sk-comments":!0},on:{input:function(t){r.note=t}}})]),e("v-card-actions",{class:{"v-card__actions":!0}},[e("v-btn",{props:{color:l,dark:!0,loading:this.adding,large:!0,disabled:this.self&&this.mustPoint},on:{click:this.to_basket},class:{"sk-to-cart":!0,"flex-grow-1":!0}},[c?e("div",{class:{"sk-in-cart":!0},style:{"background-color":"red darken-4"}},[e("sk-svg",{props:{xref:"#ico-check"}}),"в корзине"]):"заказать"]),e("v-btn",{props:{dark:!0,color:l,width:"3rem",large:!0},on:{click:this.from_basket},style:{display:c?"":"none"}},[e("sk-svg",{props:{xref:"#ico-close"}})])])])])]),e("v-bottom-sheet",{props:{value:this.sheet}},[e("v-sheet",{class:{"text-center":!0,"sk-rating-sheet":!0}},[e("h3","Нам очень важна Ваша оценка!"),e("v-rating",{props:{color:"orange","background-color":"orange"},on:{input:this.doRait}})])])])}}}).call(this,r(13))},668:function(t,e,r){var content=r(755);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(9).default)("65113143",content,!0,{sourceMap:!1})},754:function(t,e,r){"use strict";r(668)},755:function(t,e,r){(e=r(8)(!1)).push([t.i,".text-muted{color:#6c757d;font-size:.75rem;line-height:1.115}.sk-whited{background:#fff}.sk-prod-conte{margin-top:1rem;padding-bottom:160px}.sk-prod .v-image{opacity:0;border-top-left-radius:22px!important;border-top-right-radius:22px!important}.sk-prod .sk-btn-back{background:rgba(0,0,0,.18);border:1px solid hsla(0,0%,100%,.5);box-shadow:0 2px 4px rgba(0,0,0,.33);position:fixed;left:.5rem;top:.5rem;z-index:3}.sk-prod .v-toolbar{background:transparent!important;position:fixed;z-index:3}.sk-prod .v-card__text{color:#3a3a3a;background:#fafaf7;border-radius:22px 22px 0 0;border-top:1px solid #fff;padding-top:1rem;margin-top:-16px;position:relative;display:block}.sk-prod .v-card__text .sk-btn-thumb{background-size:cover!important;border:2px solid #fff;top:-34px;right:1rem;position:absolute}.sk-prod .v-card__text .sk-raiting .v-btn{margin-left:-.75rem;font-size:.9rem}.sk-prod .v-card__text .sk-raiting .v-btn svg{margin-right:.5rem;color:#ccc}.sk-prod .v-card__text .sk-name{font-size:1.5rem;font-weight:400;line-height:1.125;color:#3a3a3a;word-break:normal;margin:.5rem 0;padding:0 72px 0 0}.sk-prod .v-card__text .sk-price{margin:.5rem 0;display:flex;justify-content:space-between}.sk-prod .v-card__text .sk-price>:first-child{font-size:1rem}.sk-prod .v-card__text .sk-price>:last-child{font-size:2rem}.sk-prod .v-card__text .sk-prod-meta{display:flex}.sk-prod .v-card__text .sk-prod-meta svg{color:#ababab;width:16px;height:16px;margin-right:.5rem}.sk-prod .v-card__text .sk-quantity{margin:1rem 0 2rem;background:#fff;display:flex;align-items:center;justify-content:space-between;border:1px solid #ddd;padding:0 0 0 .5rem;font-size:1rem}.sk-prod .v-card__text .sk-quantity .v-btn--fab{position:absolute;right:1rem;left:auto}.sk-prod .v-card__text .sk-quantity>div{display:flex;align-self:flex-end;align-items:center}.sk-prod .v-card__text .sk-quantity>div .v-text-field{padding-top:0;margin-top:0}.sk-prod .v-card__text .sk-quantity>div .v-text-field .v-input__control>.v-input__slot:before{display:none}.sk-prod .v-card__text .sk-quantity>div .v-input{max-width:72px;width:64px}.sk-prod .v-card__text .sk-quantity>div .v-input input{text-align:center;font-size:1.5rem;color:inherit}.sk-prod .v-card__text .sk-quantity>div .v-btn{border-radius:0;border:0;font-size:1.5rem;width:48px;min-width:48px;height:48px;padding:0}.sk-prod .v-card__text .sk-quantity>div .v-btn:first-child{border-right:1px solid #ddd;border-left:1px solid #ddd}.sk-prod .v-card__text .sk-quantity>div .v-btn:last-child{border-left:1px solid #ddd}.sk-prod .v-card-actions,.sk-prod .v-card__actions{background:#fafaf7;border-radius:0 0 22px 22px!important;padding:1rem 0 0;box-shadow:0 4px 6px rgba(0,0,0,.18);justify-content:center;align-items:center;flex-direction:row}.sk-prod .v-card-actions .v-btn,.sk-prod .v-card__actions .v-btn{border-radius:0 0 22px 22px}.sk-prod .v-card-actions .v-btn svg,.sk-prod .v-card__actions .v-btn svg{margin-right:1rem}.sk-prod.sk-in-cart .v-card__actions .v-btn:first-child{border-radius:0 0 0 22px}.sk-prod.sk-in-cart .v-card__actions .v-btn:last-child{border-radius:0 0 22px 0;border-left:0;margin-left:-2px}.sk-rating-sheet{height:200px;display:flex;flex-direction:column;justify-content:center}.sk-rating-sheet h3{font-weight:400;margin-bottom:1.5rem}@media(min-width:960px){.sk-prod{max-width:900px;margin-left:auto;margin-right:auto}}",""]),t.exports=e},797:function(t,e,r){"use strict";r.r(e);var o=r(644).a,n=(r(754),r(29)),component=Object(n.a)(o,void 0,void 0,!1,null,null,null);e.default=component.exports}}]);